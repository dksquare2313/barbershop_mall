<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <script src="https://kit.fontawesome.com/ed72bf3575.js" crossorigin="anonymous"></script>
  

  <title>Barber Shop</title>
  <meta content="" name="descriptison">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="static/img/favicon.png" rel="icon">
  <link href="static/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="static/vendor/icofont/icofont.min.css" rel="stylesheet">
  <link href="static/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="static/vendor/animate.css/animate.min.css" rel="stylesheet">
  <link href="static/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="static/vendor/line-awesome/css/line-awesome.min.css" rel="stylesheet">
  <link href="static/vendor/venobox/venobox.css" rel="stylesheet">
  <link href="static/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="static/vendor/aos/aos.css" rel="stylesheet">



  <!-- Template Main CSS File -->
  <link href="static/css/style.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: Selecao - v2.2.0
  * Template URL: https://bootstrapmade.com/selecao-bootstrap-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->

  <style>
.vertical-menu {
  width: 200px;
}

.vertical-menu a {
  display: block;
  padding: 12px;
  text-decoration: none;
}

.vertical-menu a:hover {
  background-color: #ccc;
}

.vertical-menu a.active {
  background-color: #909090;
  color: white;
}
#viewall{

}

</style>

</head>

<body>
  <nav class="navbar navbar-dark bg-dark">
  <!-- Navbar content -->
  <div class="row">
    <div class="col-2">
       <a href="/"><img src="static/img/logo.png" alt="" class="img-fluid" ></a>
    </div>
    <div class="col"></div>
    <div class="col-1 mt-2"><button type="button" class="btn btn-link" style="color: white;">Logout</button></div>
  </div>
</nav>


  <div class="row" style="margin: 0px; margin-top: 0px;">
      <div class="col-2">
      
        <nav class="nav flex-column" style="width: 200px;">
         <button type="button" class="btn btn-dark mt-4" onclick="onDashboard()">Dashboard</button>
          <button type="button" class="btn btn-dark mt-2" onclick="onUSER()">User Account</button>
          <button type="submit" class="btn btn-dark mt-2" onclick="onQR()">QR</button>
           <button type="submit" class="btn btn-dark my-2" onclick="onView()">View All Appointments</button>
          
        </nav>
        
      </div>
      <div class="col my-4 ">
        <div class="row">
          <div class="col">
              <div class="row">
                <div class="col-3  text-left">
                  <h2 id="title">Incoming Requests</h2>
                </div>
                <div class="col mt-2">
                    <div class="add-new">
                        <button class="btn btn-dark" data-toggle="modal" data-target="#modalCart" id="addnew"><span class="fa fa-plus"></span> New Appointment</button>
                        <button class="btn btn-info ml-5" onclick="onReload()"> Reload</button>
                    </div>
                </div>
              </div>
              <div class="table-container" >
                <ul class="responsive-table">

                    <table class="table" id="dashboard">
                      <thead class="thead-dark" style="border-radius: 5px;">
                        <tr>
                          <th scope="col">#</th>
                          <th scope="col">Name:</th>
                          <th scope="col">phone:</th>
                          <th scope="col">Service:</th>
                          <th scope="col">Options:</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% for (var i =0; i < user.incoming.length;  i++ ) { %>
                            <tr>
                              <th scope="row"><%= i+1 %> </th>
                              <td><%= user.incoming[i].name %> <br>  <small><%= user.incoming[i].email %></small></td>
                               <td><%= user.incoming[i].phone %></td>
                              <td><%= user.incoming[i].service %></td>
                              <td>
                                <div class="row justify-content-end">
                                  <div class="col">
                                    <button type="button" class="btn btn-success" style="display:flex;" onclick="onAccept('<%= user.incoming[i]._id %>')">Accept <span class="fa fa-check ml-2 mt-1"></span></button>
                                  </div>
                                  <div class="col">
                                    <button type="button" class="btn btn-danger" style="display:flex;" onclick="onReject('<%= user.incoming[i]._id %>')">Reject <span class="fa fa-close ml-2 mt-1"></span></button>
                                  </div>
                                </div>
                              </td>
                            </tr>
                        <% } %>
                      
                      </tbody>
                    </table>


                    <table class="table" id="viewall" hidden>
                      <thead class="thead-dark" style="border-radius: 5px;">
                        <tr>
                          <th scope="col">#</th>
                          <th scope="col">Name:</th>
                          <th scope="col">phone:</th>
                          <th scope="col">Service:</th>
                          <th scope="col">Options:</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% for (var i =0; i < user.user.appointment.length;  i++ ) { %>
                            <tr>
                              <th scope="row"><%= i+1 %> </th>
                              <td><%= user.user.appointment[i].name %> <br>  <small><%= user.user.appointment[i].email %></small></td>
                               <td><%= user.user.appointment[i].phone %></td>
                              <td><%= user.user.appointment[i].service %></td>
                              <td>
                                <div class="row justify-content-end">
                                  <div class="col">
                                    <button type="button" class="btn btn-danger" style="display:flex;" onclick="onReject('<%= user.user.appointment[i]._id %>')">Delete <span class="fa fa-close ml-2 mt-1"></span></button>
                                  </div>
                                </div>
                              </td>
                            </tr>
                        <% } %>
                      
                      </tbody>
                    </table>
                </ul>
              </div>
          </div>
        </div>
        <script>
          function onView(){
            document.getElementById("title").innerText = "All Appointments";
            document.getElementById("addnew").hidden = true;
            document.getElementById("ongoing").hidden = true;
            document.getElementById("dashboard").hidden = true;
            document.getElementById("viewall").hidden = false;
          }

          function onDashboard(){
            document.getElementById("title").innerText = "All Appointments";
            document.getElementById("addnew").hidden = false;
            document.getElementById("ongoing").hidden = false;
            document.getElementById("dashboard").hidden = false;
            document.getElementById("viewall").hidden = true;
          }
          function onQR(){
            window.location.href = '/qr';
          }
          function onUSER(){
            window.location.href = '/user';
          }
          function onReload(){
            window.location.reload();
          }
        </script>
        <!-- script for incoming  -->
        <script>
          

           async function onAccept(obj){
            var newURL = window.location.protocol + "//" + window.location.host + "/accept";
            await fetch(newURL, {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ "appid": obj,"id":"<%= user.user._id %>" })
            })
            .then(()=>{window.location.reload()})

          }

          async function onReject(obj){
            var newURL = window.location.protocol + "//" + window.location.host + "/reject";
            await fetch(newURL, {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ "appid": obj,"id":"<%= user.user._id %>" })
            })
            .then(()=>{window.location.reload()})
          }

        </script>


         <div class="row" id="ongoing">
          <div class="col">
              <div class="row">
                <div class="col-3  text-left">
                  <h2>Ongoing Requests</h2>
                </div>
               
              </div>
              <div class="table-container">
                <ul class="responsive-table">

                    <table class="table">
                      <thead class="thead-dark" style="border-radius: 5px;">
                        <tr>
                          <th scope="col">#</th>
                          <th scope="col">Name:</th>
                          <th scope="col">Phone:</th>
                          <th scope="col">Service:</th>
                          <th scope="col">Options:</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% for (var i =0; i < user.ongoing.length;  i++ ) { %>

                            <tr>
                              <th scope="row"><%= i+1 %> </th>
                              <td><%= user.ongoing[i].name %> <br>  <small><%= user.ongoing[i].email %></small></td>
                              <td><%= user.ongoing[i].phone %></td>
                              <td><%= user.ongoing[i].service %></td>
                              <td>
                                <div class="row">
                                  <div class="col">
                                    <button type="button" class="btn btn-success" style="display:flex;" onclick="onComplete('<%= user.ongoing[i]._id %>')" >Complete <span class="fa fa-check ml-2 mt-1"></span></button>
                                  </div>
                                  <div class="col">
                                    <button type="button" class="btn btn-warning" style="display:flex;" onclick="onPush('<%= user.ongoing[i]._id %>')">Push <span class="fa fa-arrow-down ml-2 mt-1"></span></button>
                                  </div>
                                  <div class="col">
                                    <button type="button" class="btn btn-danger" style="display:flex;" onclick="onDelete('<%= user.ongoing[i]._id %>')">Delete <span class="fa fa-close ml-2 mt-1"></span></button>
                                  </div>
                                </div>
                              </td>
                            </tr>

                        
                        <% } %>
                      
                      </tbody>
                    </table>
                </ul>
              </div>
          </div>
        </div>

        <!-- script for ongoing  -->
        <script>

          async function onComplete(obj){
             var newURL = window.location.protocol + "//" + window.location.host + "/complete";
            await fetch(newURL, {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ "appid": obj,"id":"<%= user.user._id %>" })
            })
            .then(()=>{window.location.reload()})
          }

           async function onPush(obj){
            
             var newURL = window.location.protocol + "//" + window.location.host + "/push";
            await fetch(newURL, {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ "appid": obj,"id":"<%= user.user._id %>" })
            })
            .then(()=>{window.location.reload()})

          }

          async function onDelete(obj){

                var newURL = window.location.protocol + "//" + window.location.host + "/delete";
            await fetch(newURL, {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ "appid": obj,"id":"<%= user.user._id %>" })
            })
           .then(()=>{window.location.reload()})
          }


        </script>
        
      </div>
    </div>
  
    <!-- Modal: modalCart -->
<div class="modal fade" id="modalCart" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
aria-hidden="true">
<div class="modal-dialog" role="document">
  <div class="modal-content">
    <!--Header-->
    <div class="modal-header">
      <h4 class="modal-title" id="myModalLabel">Book You Appointment</h4>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">×</span>
      </button>
    </div>
    <!--Body-->
    <div class="modal-body">

      <form method="post" action="/appoinment1">
          <input type="hidden" name="id" value="<%= user.user._id %>">
            <div class="form-group">
              <label for="exampleFormControlSelect1">Example select</label>
              <select class="form-control" name="service" id="service">
                
              </select>
            </div>
            <div class="form-group">
              <label for="exampleInputEmail1">Email:</label>
              <input type="email" class="form-control" name="email" placeholder="Enter email">
            </div>
            <div class="form-group">
              <label for="exampleInputEmail1">Name:</label>
              <input type="text" class="form-control" name="name" placeholder="Enter name">
            </div>
            <div class="form-group">
              <label for="exampleInputEmail1">Phone:</label>
              <input type="number" class="form-control" name="phone" placeholder="Enter name">
            </div>
          <button type="submit" class="btn btn-success">Submit</button>
          <button type="button" class="btn btn-outline-danger" data-dismiss="modal">Close</button>
      </form>


        <script>
        let data = [
          {tag:"Hair cut",time:20},
          {tag:"Haircut with beard trim",time:35},
          {tag:"Edge up",time:10},
          {tag:"Beard trim",time:15},
          {tag:"Straight razor shave",time:30},
          {tag:"Hair color",time:35},
          {tag:"Beard color",time:30},
          {tag:"Facial and black mask",time:50},
          {tag:"Shampoo",time:15},
        ]
        let opt = document.getElementById("service");
        
        for (let index = 0; index < data.length; index++) {
          let option = document.createElement("option");
          option.innerText = data[index].tag+" - "+data[index].time;
          opt.appendChild(option);
        }
      </script>

      
    </div>

  </div>
</div>
</div>
<!-- Modal: modalCart -->
  
  

  <!-- ======= Footer ======= -->
  <footer id="footer">
    <div class="container">

      <a href="index.html"><img src="static/img/logo.png" alt="logo" class="my-5" height="100px"></a>


      <div class="social-links">
        <!-- <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a> -->
        <a href="https://www.facebook.com/Christianbarbersalon" target="_blank" class="facebook"><i class="bx bxl-facebook"></i></a>
        <a href="https://instagram.com/ashavinggrace?igshid=YmMyMTA2M2Y=" target="_blank" class="instagram"><i class="bx bxl-instagram"></i></a>
        <a href="https://maps.app.goo.gl/jzYqgFXZ7s7KvCL66?g_st=ic" target="_blank" class="google-plus"><i class="bx bxl-skype"></i></a>
        <!-- <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a> -->
      </div>
      <div class="copyright">


        &copy; Copyright <strong><span>AShavingGraceBarberShop</span></strong>. All Rights Reserved

      </div>
      <div class="credits">
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/selecao-bootstrap-template/ -->
        
      </div>
    </div>
  </footer><!-- End Footer -->
  

  <a href="#" class="back-to-top"><i class="ri-arrow-up-line"></i></a>


  <!-- Start of LiveChat (www.livechat.com) code -->
<script>
    window.__lc = window.__lc || {};
    window.__lc.license = 14723673;
    ;(function(n,t,c){function i(n){return e._h?e._h.apply(null,n):e._q.push(n)}var e={_q:[],_h:null,_v:"2.0",on:function(){i(["on",c.call(arguments)])},once:function(){i(["once",c.call(arguments)])},off:function(){i(["off",c.call(arguments)])},get:function(){if(!e._h)throw new Error("[LiveChatWidget] You can't use getters before load.");return i(["get",c.call(arguments)])},call:function(){i(["call",c.call(arguments)])},init:function(){var n=t.createElement("script");n.async=!0,n.type="text/javascript",n.src="https://cdn.livechatinc.com/tracking.js",t.head.appendChild(n)}};!n.__lc.asyncInit&&e.init(),n.LiveChatWidget=n.LiveChatWidget||e}(window,document,[].slice))
</script>
<noscript><a href="https://www.livechat.com/chat-with/14723673/" rel="nofollow">Chat with us</a>, powered by <a href="https://www.livechat.com/?welcome" rel="noopener nofollow" target="_blank">LiveChat</a></noscript>
<!-- End of LiveChat code -->

  <!-- Vendor JS Files -->
  <script src="static/vendor/jquery/jquery.min.js"></script>
  <script src="static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="static/vendor/jquery.easing/jquery.easing.min.js"></script>
  <script src="static/vendor/php-email-form/validate.js"></script>
  <script src="static/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="static/vendor/venobox/venobox.min.js"></script>
  <script src="static/vendor/owl.carousel/owl.carousel.min.js"></script>
  <script src="static/vendor/aos/aos.js"></script>

  <!-- Template Main JS File -->
  <script src="static/js/main.js"></script>

  <script>
    setInterval(function() {
                  window.location.reload();
                }, 300000); 
  </script>


</body>

</html>